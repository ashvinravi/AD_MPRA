---
title: "iMGL MPRA Library"
subtitle: "View Library"
author: |
 | Ashvin Ravi
 | Raj Lab
 | Department of Neuroscience
 | Icahn School of Medicine at Mount Sinai
 | NYC, New York
output: 
 rmarkdown::html_document:
   theme: cerulean
   highlight: haddock
   code_folding: hide
   toc: true
   toc_float: true
   smooth_scroll: true
   number_sections: false
   self_contained: true
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## MPRA Library
This markdown shows which source each of the 11,805 variants tested in the MPRA come from. 

**The variants come from the following sources:** \

1. All microglia 300-donor eQTL significant variants (FDR <= 0.05) + SNPs in LD (r2 > 0.8)  that are found in significant (FDR <= 0.05) microglia ATAC-seq peaks \
2. All microglia 300-donor eQTL significant lead SNPs (FDR <= 0.05) + SNPs in LD (r2 > 0.8) that are found in significant enhancers identified by the Activity-by-Contact Model (ABC Score >= 0.02) \
3. All microglia 300-donor eQTL significant lead SNPs (FDR <= 0.05), regardless of whether they are found in ATAC-seq peaks or not \
4. Results from fine-mapping chromatin accessibility QTLs via eCAVIAR (PP >= 0.5) - Roussos Lab (https://www.medrxiv.org/content/10.1101/2021.10.17.21264910v1.full) \
5. Results from fine-mapping latest EADB GWAS (Bellenguez 2021) using SuSiE (PIP >= 0.01) with pre-computed LD based on the GWAS population \
6. Published results from fine-mapping Schwartzentruber (2020) GWAS meta-analysis (PP >= 0.01) - Jeremy Schwartzentruber (https://www.nature.com/articles/s41588-020-00776-w) \
7. All lead SNPs from the 4 most recent Alzheimerâ€™s Disease GWAS (Bellenguez 2021, Kunkle 2019, Jansen 2018, Schwartzentruber 2020) \

```{r createDT, echo=FALSE, message=FALSE, warning=FALSE}
library(DT)
createDT <- function(DF, caption="", scrollY=500){
  data <- DT::datatable(DF, caption=caption,
    extensions =  'Buttons',
    options = list( dom = 'Bfrtip', 
                    buttons = c('copy', 'csv', 'excel', 'pdf', 'print'), 
                    scrollY = scrollY, scrollX=T, scrollCollapse = T, paging = F,  
                      columnDefs = list(list(className = 'dt-center', targets = "_all"))
    )
  ) 
   return(data)
}
```

## Interactive MPRA Library Table
We provide a table to query tested variants in the MPRA based on the prioritization method. 
```{r view_mpra_library, warning=F, show_col_types = FALSE}
library(readr)

setwd('/Users/ashvinravi/Desktop/AD_MPRA/')
mpra_table <- read_tsv('iMGL_MPRA_consensus_table.tsv', show_col_types=F)
createDT(mpra_table)

```



